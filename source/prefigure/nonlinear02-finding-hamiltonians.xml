<prefigure xmlns="https://prefigure.org"
             label="finding-hamiltonians">

<diagram dimensions="(300,300)" margins="25">
  <definition>f(t,y) = (y[0]^2*sin(y[0])*cos(y[1]), 2*y[0] - sin(y[1])*(2*y[0]*sin(y[0]) + y[0]^2*cos(y[0])))</definition>
  <coordinates bbox="[-6,-6,6,6]">
    <grid-axes xlabel="x(t)" ylabel="y(t)"/>

    <definition>gap = 3/4</definition>
    <slope-field function="f" system="yes" stroke="black"
     arrows="yes" thickness="1" spacings="((-6,gap,6),(-6,gap,6))"/>

    <definition>H(x,y) = x^2*(1 - sin(x)*sin(y))</definition>
    <implicit-curve function="H" k="-1" stroke="cyan" />
    <implicit-curve function="H" k="-0.5" stroke="red" />
    <implicit-curve function="H" k="-0.1" stroke="green" />
    <implicit-curve function="H" k="0" stroke="purple" />
    <implicit-curve function="H" k="0.1" stroke="brown" />
    <implicit-curve function="H" k="0.5" stroke="blue" />
    <implicit-curve function="H" k="1" stroke="magenta" />
    <implicit-curve function="H" k="3" stroke="orange" />
    <implicit-curve function="H" k="6" stroke="green" />
    <implicit-curve function="H" k="9" stroke="magenta" />
  </coordinates>

       <!--
      <annotations>
      <annotation ref="figure"
            text="Direction field for x prime equals minus x squared times cosine y times sine x and y prime equals x squared times cosine x times sine y plus 2 times x times the quantity sine x sine y minus 1.  The solution curves are either waves near the vertical axis or closed orbits.
            "/>
    </annotations>
    -->

</diagram>

</prefigure>

