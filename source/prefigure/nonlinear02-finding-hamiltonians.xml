<prefigure xmlns="https://prefigure.org"
             label="finding-hamiltonians">

<diagram dimensions="(300,300)" margins="25">
  <definition>f(t,y) = (y[0]^2*sin(y[0])*cos(y[1]), 2*y[0] - sin(y[1])*(2*y[0]*sin(y[0]) + y[0]^2*cos(y[0])))</definition>
  <coordinates bbox="[-6,-6,6,6]">
    <grid-axes xlabel="x(t)" ylabel="y(t)"/>

    <definition>gap = 1</definition>
    <slope-field function="f" system="yes" stroke="black"
     arrows="yes" thickness="1" spacings="((-6,gap,6),(-6,gap,6))"/>

    <definition>H(x,y) = x^2*(1 - sin(x)*sin(y))</definition>
    <implicit-curve function="H" k="-1" stroke="cyan" />
    <implicit-curve function="H" k="-0.5" stroke="red" />
    <implicit-curve function="H" k="-0.1" stroke="green" />
    <implicit-curve function="H" k="0" stroke="purple" />
    <implicit-curve function="H" k="0.1" stroke="brown" />
    <implicit-curve function="H" k="0.5" stroke="blue" />
    <implicit-curve function="H" k="1" stroke="magenta" />
    <implicit-curve function="H" k="3" stroke="orange" />
    <implicit-curve function="H" k="6" stroke="green" />
    <implicit-curve function="H" k="9" stroke="magenta" />
  </coordinates>
</diagram>

</prefigure>


<!--
            <figure xml:id="nonlinear02-figure-finding-hamiltonians">

                <image width="60%" xml:id="nonlinear02-finding-hamiltonians">
                    <description>solution curves as level sets on a direction field of slope arrows</description>
                    <sageplot>
                        x, y, t = var('x y t')
                        xmin = -6
                        xmax = 6
                        ymin = -6
                        ymax = 6
                        H(x,y) = x^2*(1 - sin(x)*sin(y))
                        f = diff(H,y)
                        g = -diff(H,x)
                        n = sqrt(f^2 + g^2)
                        p = plot_vector_field( (f/n,g/n), (x,xmin,xmax), (y,ymin,ymax), axes_labels=['$x(t)$','$y(t)$'],aspect_ratio=1)
                        p += contour_plot(H, (x,xmin,xmax), (y,ymin,ymax), fill=False, cmap='hsv', contours=[-1,-0.5, -0.1, 0,0.1, 0.5, 1,3, 6, 9])
                        p
                    </sageplot>
                </image>
                <caption>Solution curves for <xref ref="nonlinear02-example-finding-hamiltonians" /></caption>
            </figure>
    -->   