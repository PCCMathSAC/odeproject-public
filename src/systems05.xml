<?xml version="1.0" encoding="UTF-8"?>

<!-- This file is part of the book                                 -->
<!--                                                               -->
<!--    Ordinary Differential Equations Project                    -->
<!--                                                               -->
<!-- Copyright (C) 2013-2020 Thomas W. Judson                      -->
<!-- See the file COPYING for copying conditions.                  -->

<section xml:id="systems05" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Projects for Systems of Differential Equations</title>
    
    <project xml:id="systems05-project-epidemiology">
        <title>Mathematical Epidemiology 101</title>

        <introduction>
			<p>Systems of differential equations are very useful in epidemiology. Differential equations can be used to model various epidemics, including the bubonic plague, influenza, AIDS, the 2015 ebola outbreak in west Africa, and currently the 2020<ndash />2021 coronavirus pandemic. To understand how we might model an epidemic, we will consider a very simple situation. We will assume that we have a closed population of size <m>N</m>, where immigration, emigration, and birth do not play an important role. We will also ignore any deaths that are not related to our disease.</p>

			<p>We will assume that each individual in the population falls into one of the following categories: 
				<md>
					<mrow>S(t) \amp = \text{Susceptible individuals}</mrow>
					<mrow>I(t) \amp = \text{Infected individuals}</mrow>
					<mrow>R(t) \amp = \text{Removed individuals}</mrow>
				</md>
			Susceptible individuals are those who do not yet have the disease and can catch the disease from infected individuals. Individuals enter the removed population by either recovering from the disease or dying. If an infected individual recovers, then the individual is immune to the disease. Schematically, we can represent the effect of the disease by the diagram
				<me>S \longrightarrow I \longrightarrow R.</me>
			Since the population is closed, we know that
				<me>S(t) + I(t) + R(t) = N.</me>
			This model is called an <term>SIR model</term>.</p>

			<p>We can model how the disease acts with the following system of equations,
				<md>
					<mrow>\frac{dS}{dt} \amp = - \alpha SI</mrow>
					<mrow>\frac{dI}{dt} \amp = \alpha SI - \beta I</mrow>
					<mrow>\frac{dR}{dt} \amp = \beta I.</mrow>
				</md>
			We say that <m>\alpha</m> is the rate of infection and <m>\beta</m> is the rate at which the infected are removed. That is, an infected individual either dies or recovers after <m>1/ \beta</m> days. Since
				<me>\frac{d}{dt}\left[ S(t) + I(t) + R(t)\right] = \frac{d}{dt} N = 0,</me>
			we need only solve the system
				<md>
					<mrow>\frac{dS}{dt} \amp = - \alpha SI</mrow>
					<mrow>\frac{dI}{dt} \amp = \alpha SI - \beta I.</mrow>
				</md>
			This is a nonlinear system, but it can be solved numerically. Suppose that <m>\alpha = 0.005</m> and <m>\beta = 0.08</m>, we can use Sage to create a graph of the solutions.</p>

			<sage>
	            <input>
				S, Infected, t = var('S, Infected, t')
				alpha = 0.005
				beta = 0.08
				F = [-alpha*S*Infected, alpha*S*Infected - beta*Infected]
				P = desolve_system_rk4(F,[S, Infected],ics=[0,100,1],ivar=t,end_points=80,step=0.1)
				Q = [ [i, j] for i,j,k in P]
				R = [ [i, k] for i,j,k in P]
				LQ = line(Q, color='red', axes_labels=['$t$','$S(t), I(t)$'], legend_label='$S(t)$', legend_color='red', fontsize=12, thickness=2)
				LR = line(R, color='blue', legend_label='$I(t)$', legend_color='blue', thickness=2)
				p = LQ + LR
				p
	            </input>
	            <output>
	            </output>
	        </sage>
		</introduction>


		<task>
			<statement>
				<p>Describe what the parameters <m>\alpha</m> and <m>\beta</m> mean in terms of the epidemic.</p>
			</statement>
		</task>

		<task>
			<statement>
				<p>Modify the parameters <m>\alpha</m> and <m>\beta</m> to create at least three additional graphs similar to the one in the Sage cell. Clearly state each of the three different parameter values you used. You should not need to make drastic changes to the parameter to get different results.</p>
			</statement>
			<sage>
	            <input>
	            </input>
	            <output>
	            </output>
	        </sage>				
		</task>

		<task>
			<statement>
				<p>Describe what the parameters <m>\alpha</m> and <m>\beta</m> mean in terms of the epidemic.</p>
			</statement>
		</task>

		<task>
			<statement>
				<p>For each of your three modified parameter values and the original value answer the following questions.
					<ol>

						<li><p>What is maximum value of the infected population (in terms of <m>N</m>?</p></li>

						<li><p>At what time does the maximum infected population occur?</p></li>

					</ol></p>
			</statement>
		</task>

		<task>
			<statement>
				<p>Summarize how the changes in your parameter affected your results to the previous question.</p>
			</statement>
		</task>

		<task>
			<statement>
				<p>In the SIR model, we have three populations: susceptible, infected, and removed. In the <term>SEIR model</term>, we have an additional population <m>E</m>, which are individuals exposed the the disease. Explain the equations
					<md>
						<mrow>\frac{dS}{dt} \amp = - \alpha SI</mrow>
						<mrow>\frac{dE}{dt} \amp = \alpha SI - \beta E</mrow>
						<mrow>\frac{dI}{dt} \amp = \beta E - \gamma I</mrow>
						<mrow>\frac{dR}{dt} \amp = \gamma I.</mrow>
					</md>
				for the SEIR model.</p>
			</statement>
		</task>
<!--
			<task>
				<statement>
					<p>The data in <xref ref="systems05-table-flu-data" /> comes from an outbreak of influenza in an English boarding school</p>

				<table xml:id="systems05-table-flu-data">
		            <title>Total Number of Bedridden Boys on Day <m>t</m></title>
		            <tabular halign="center" top="medium">
		                <row bottom="medium">
		                    <cell>Time (days)</cell><cell>0</cell><cell>1</cell><cell>2</cell><cell>3</cell><cell>4</cell><cell>5</cell><cell>6</cell><cell>7</cell><cell>8</cell><cell>9</cell><cell>10</cell><cell>11</cell><cell>12</cell><cell>13</cell>
		                </row>
		                <row bottom="medium">
		                    <cell>Number of cases</cell><cell>1</cell><cell>3</cell><cell>25</cell><cell>72</cell><cell>222</cell><cell>282</cell><cell>256</cell><cell>233</cell><cell>189</cell><cell>123</cell><cell>70</cell><cell>25</cell><cell>11</cell><cell>4</cell>
		                </row>
		            </tabular>      
        		</table>

				</statement>
			</task>
-->
		<conclusion>

	        <p>There are many questions associated with epidemic models. Here are a few.
	            <ul>

	                <li>Will there be an epidemic?</li>

	                <li>If there is an epidemic, how many individuals will be infected?</li>

	                <li>Is there a period of time for which individuals are exposed to the disease but exhibit no symptoms and cannot infect others?</li>

	                <li>If the disease is endemic, what is the prevalence of the infection?</li>

	                <li>Can the disease be eradicated or controlled?</li>

	                <li>What is the effect of the population age structure?</li>

	            </ul></p>
		</conclusion>

	</project>



</section>

